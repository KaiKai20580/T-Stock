@{
    var now = DateTime.Now;
}

    <title>Inventory Summary Report</title>


<body class="sreport-body">

    <div class="sreport-header">
        <div class="sreport-company">TAR UMT INVENTORY MANAGEMENT SYSTEM</div>
        <div class="sreport-address">
            Tunku Abdul Rahman University of Management and Technology<br />
            Jalan Genting Kelang, 53300 Kuala Lumpur, Malaysia<br />
            Tel: 03-4145 0123 • Email: inventory@tarumt.edu.my
        </div>
        <div class="sreport-title">INVENTORY SUMMARY REPORT</div>
        <div class="sreport-period">For the month of @ViewBag.ReportMonth</div>
    </div>

    <table class="sreport-table sreport-no-border">
        <tr>
            <td width="300"><strong>Report Generated Date</strong></td>
            <td>: @ViewBag.GeneratedDate</td>
        </tr>
        <tr>
            <td><strong>Generated By</strong></td>
            <td>: @ViewBag.GeneratedBy</td>
        </tr>
    </table>

    <table class="sreport-table">
        <thead>
            <tr>
                <th width="60">No.</th>
                <th>Description</th>
                <th width="150" class="sreport-text-right">Quantity</th>
                <th width="150" class="sreport-text-right">Items</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>1</td>
                <td>Total Active Products</td>
                <td class="sreport-text-right">-</td>
                <td class="sreport-text-right">@ViewBag.ActiveProducts</td>
            </tr>
            <tr>
                <td>2</td>
                <td>Total Stock Quantity</td>
                <td class="sreport-text-right">@ViewBag.TotalStockQty units</td>
                <td class="sreport-text-right">-</td>
            </tr>
            <tr>
                <td>3</td>
                <td>Out of Stock Items</td>
                <td class="sreport-text-right">-</td>
                <td class="sreport-text-right">@ViewBag.OutOfStockCount</td>
            </tr>
            <tr><td colspan="4" class="sreport-total"></td></tr>
            <tr>
                <td colspan="2" class="sreport-text-right sreport-double">
                    TOTAL STOCK QUANTITY
                </td>
                <td class="sreport-text-right sreport-double">
                    @ViewBag.TotalStockQty units
                </td>
                <td class="sreport-text-right sreport-double">-</td>
            </tr>
        </tbody>
    </table>

    <h3 style="text-decoration:underline; margin-top:40px;">
        Top 10 Highest Stock Quantity Items
    </h3>

    <table class="sreport-table">
        <thead>
            <tr>
                <th width="40">No</th>
                <th width="100">Product Code</th>
                <th>Product Name</th>
                <th width="100">Category</th>
                <th width="80" class="sreport-text-right">Price (RM)</th>
                <th width="80" class="sreport-text-right">Qty</th>
                <th width="100" class="sreport-text-right">Total Value (RM)</th>
            </tr>
        </thead>
        <tbody>
            @if (ViewBag.Top10Items != null)
            {
                foreach (var item in ViewBag.Top10Items)
                {
                    <tr>
                        <td>@item.No</td>
                        <td>@item.ProductId</td>
                        <td>@item.ProductName</td>
                        <td>@item.Category</td>
                        <td class="sreport-text-right">@item.Price.ToString("N2")</td>
                        <td class="sreport-text-right">@item.Quantity.ToString("N0")</td>
                        <td class="sreport-text-right">@item.TotalValue.ToString("N2")</td>
                    </tr>
                }
            }

            <tr>
                <td colspan="5" class="sreport-text-right sreport-total">
                    Sub Total (Top 10)
                </td>
                <td class="sreport-text-right sreport-total">
                    @((ViewBag.Top10TotalQty != null) ? ((long)ViewBag.Top10TotalQty).ToString("N0") : "0")
                </td>
                <td class="sreport-text-right sreport-total">
                    @((ViewBag.Top10TotalValue != null) ? ((decimal)ViewBag.Top10TotalValue).ToString("N2") : "0.00")
                </td>
            </tr>
        </tbody>
    </table>

    <div style="margin-top:60px;">
        <table class="sreport-no-border" style="width:100%">
            <tr>
                <td width="33%">_________________<br />Prepared By</td>
                <td width="33%">_________________<br />Checked By</td>
                <td width="34%">_________________<br />Approved By</td>
            </tr>
            <tr>
                <td>Name: @ViewBag.GeneratedBy</td>
                <td>Name:</td>
                <td>Name:</td>
            </tr>
            <tr>
                <td>Date: @now.ToString("dd/MM/yyyy")</td>
                <td>Date:</td>
                <td>Date:</td>
            </tr>
        </table>
    </div>

    <div class="sreport-footer">
        This is a computer-generated report • Page 1 of 1
    </div>

</body>